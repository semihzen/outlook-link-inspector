function openConfirmationPopup(e){window.open("https://localhost:3000/popup.html?url=".concat(encodeURIComponent(e)),"LinkConfirm","width=440,height=400")}Office.onReady(function(e){console.log("üü° Office.onReady has begin:",e),e.host===Office.HostType.Outlook&&(console.log("‚úÖ Outlook host detected"),Office.context.mailbox.item.body.getAsync("html",{asyncContext:null},function(e){if(e.status===Office.AsyncResultStatus.Succeeded){for(var n,o=e.value,t=/<a\s+(?:[^>]*?\s+)?href=(["'])(.*?)\1/gi,i=[];null!==(n=t.exec(o));)i.push(n[2]);var l=document.getElementById("linkContainer");l.innerHTML="",0===i.length?l.innerText="No links found in this email.":i.forEach(function(e){var n=document.createElement("div");n.className="link-box";var o=document.createElement("a");o.href="#",o.textContent=e,o.className="link-text",o.title="Click to open confirmation dialog",o.onclick=function(n){n.preventDefault(),openConfirmationPopup(e)},n.appendChild(o),l.appendChild(n)})}else console.error("‚ùå Could not load email body:",e.error)}))});